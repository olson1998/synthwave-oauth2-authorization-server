<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
                   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                   xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
                                        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.1.xsd">
    <changeSet id="com.github.olson1998.synthwave.service.authorizationserver.application.datasource.entity.UserData" author="{server.hostname}">
        <createTable tableName="USRDTA">
            <column name="UID" type="bigint">
                <constraints primaryKey="true"/>
            </column>
            <column name="USRNME" type="varchar(50)">
                <constraints unique="true" nullable="false"/>
            </column>
            <column name="USRENB" type="tinyint">
                <constraints nullable="false"/>
            </column>
            <column name="USREXP" type="varchar(255)"/>
        </createTable>
    </changeSet>
    <changeSet id="com.github.olson1998.synthwave.service.authorizationserver.application.datasource.entity.AffiliationData" author="{server.hostname}">
        <createTable tableName="USRAFF">
            <column name="UID" type="bigint">
                <constraints foreignKeyName="AFFUID" referencedTableName="USRDTA" referencedColumnNames="UID" primaryKey="true" nullable="false"/>
            </column>
            <column name="CODE" type="varchar(10)">
                <constraints nullable="false"/>
            </column>
            <column name="DIVI" type="varchar(3)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint constraintName="AFFPRP" tableName="USRAFF" columnNames="CODE,DIVI"/>
    </changeSet>
    <changeSet id="com.github.olson1998.synthwave.service.authorizationserver.application.datasource.entity.UserPasswordData" author="{server.hostname}">
        <createTable tableName="PSSDTA">
            <column name="PSSID" type="bigint">
                <constraints primaryKey="true"/>
            </column>
            <column name="UID" type="bigint">
                <constraints foreignKeyName="PSSUID" referencedTableName="USRDTA" referencedColumnNames="UID" primaryKey="true" nullable="false"/>
            </column>
            <column name="PSSVAL" type="varchar(4095)">
                <constraints nullable="false"/>
            </column>
            <column name="PSEXPD" type="varchar(255)"/>
            <column name="PSSVER" type="tinyint">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="com.github.olson1998.synthwave.service.authorizationserver.application.datasource.entity.UserAccountLockData" author="{server.hostname}">
        <createTable tableName="ACCLOC">
            <column name="LOCKID" type="bigint">
                <constraints primaryKey="true" nullable="false"/>
            </column>
            <column name="UID" type="bigint">
                <constraints foreignKeyName="ACCUID" referencedTableName="USRDTA" referencedColumnNames="UID" nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="com.github.olson1998.synthwave.service.authorizationserver.application.datasource.entity.RegisteredClientData" author="{server.hostname}">
        <createTable tableName="RCLTDT">
            <column name="RCLTID" type="bigint">
                <constraints primaryKey="true"/>
            </column>
            <column name="UID" type="bigint">
                <constraints foreignKeyName="RCTUID" referencedTableName="USRDTA" referencedColumnNames="UID" primaryKey="true" nullable="false"/>
            </column>
            <column name="RCLTNM" type="varchar(255)">
                <constraints nullable="false" unique="true"/>
            </column>
            <column name="RCTYPE" type="tinyint">
                <constraints nullable="false"/>
            </column>
        </createTable>
    </changeSet>
    <changeSet id="com.github.olson1998.synthwave.service.authorizationserver.application.datasource.entity.AffiliationBasedTokenSettingsData" author="{server.hostname}">
        <createTable tableName="AFFTSG">
            <column name="CODE" type="varchar(10)">
                <constraints nullable="false"/>
            </column>
            <column name="DIVI" type="varchar(3)">
                <constraints nullable="false"/>
            </column>
            <column name="EXPPAC" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="EXPPAT" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="ACCTKF" type="varchar(14)">
                <constraints nullable="false"/>
            </column>
            <column name="EXPPDC" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="RRFTKN" type="tinyint">
                <constraints nullable="false"/>
            </column>
            <column name="EXPPRT" type="varchar(255)">
                <constraints nullable="false"/>
            </column>
            <column name="ITKALG" type="tinyint">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint constraintName="TKSAFF" tableName="USRAFF" columnNames="CODE,DIVI"/>
    </changeSet>
    <changeSet id="org.springframework.security.oauth2.core.AuthorizationGrantType" author="{server.hostname}">
        <createTable tableName="O2AUGT">
            <column name="AUGTVL" type="varchar(80)">
                <constraints primaryKey="true" nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint tableName="O2AUGT" columnNames="AUGTVL"/>
        <insert tableName="O2AUGT">
            <column name="AUGTVL">authorization_code</column>
        </insert>
        <insert tableName="O2AUGT">
            <column name="AUGTVL">refresh_token</column>
        </insert>
        <insert tableName="O2AUGT">
            <column name="AUGTVL">client_credentials</column>
        </insert>
        <insert tableName="O2AUGT">
            <column name="AUGTVL">password</column>
        </insert>
        <insert tableName="O2AUGT">
            <column name="AUGTVL">urn:ietf:params:oauth:grant-type:jwt-bearer</column>
        </insert>
        <insert tableName="O2AUGT">
            <column name="AUGTVL">urn:ietf:params:oauth:grant-type:device_code</column>
        </insert>
    </changeSet>
    <changeSet id="com.github.olson1998.synthwave.service.authorizationserver.application.datasource.entity.AuthorizationGrantTypeBindData" author="{server.hostname}">
        <createTable tableName="RCLTGT">
            <column name="RCLTID" type="bigint">
                <constraints foreignKeyName="BAGTCI" referencedTableName="RCLTDT" referencedColumnNames="RCLTID" nullable="false"/>
            </column>
            <column name="AUTHGT" type="varchar(80)">
                <constraints foreignKeyName="BAGGTV" referencedTableName="O2AUGT" referencedColumnNames="AUGTVL" nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint constraintName="BAGUCT" tableName="RCLTGT" columnNames="RCLTID,AUTHGT"/>
    </changeSet>
    <changeSet id="com.github.olson1998.synthwave.service.authorizationserver.application.datasource.entity.ClientAuthenticationMethodBoundData" author="{server.hostname}">
        <createTable tableName="RCLTAM">
            <column name="RCLTID" type="bigint">
                <constraints foreignKeyName="BCAMCI" referencedTableName="RCLTDT" referencedColumnNames="RCLTID" nullable="false"/>
            </column>
            <column name="METHOD" type="varchar(80)"/>
        </createTable>
        <addUniqueConstraint constraintName="BCAMCT" tableName="RCLTAM" columnNames="RCLTID,METHOD"/>
    </changeSet>
    <changeSet id="com.github.olson1998.synthwave.service.authorizationserver.application.datasource.entity.constant.RedirectURIScope" author="{server.hostname}">
        <createTable tableName="URISCP">
            <column name="SCPVAL" type="varchar(11)">
                <constraints nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint constraintName="RURISC" tableName="URISCP" columnNames="SCPVAL"/>
        <insert tableName="URISCP">
            <column name="SCPVAL">POST_LOGIN</column>
        </insert>
        <insert tableName="URISCP">
            <column name="SCPVAL">POST_LOGOUT</column>
        </insert>
    </changeSet>
    <changeSet id="com.github.olson1998.synthwave.service.authorizationserver.application.datasource.entity.RedirectURIData" author="{server.hostname}">
        <createTable tableName="REDURI">
            <column name="URIID" type="bigint">
                <constraints primaryKey="true"/>
            </column>
            <column name="URISCP" type="varchar(10)">
                <constraints foreignKeyName="RUISCP" referencedTableName="URISCP" referencedColumnNames="SCPVAL" nullable="false"/>
            </column>
            <column name="URIVAL" type="varchar(255)">
                <constraints primaryKey="true" nullable="false"/>
            </column>
        </createTable>
        <addUniqueConstraint constraintName="RURIVL" tableName="REDURI" columnNames="URISCP,URIVAL"/>
    </changeSet>
    <changeSet id="com.github.olson1998.synthwave.service.authorizationserver.application.datasource.entity.RedirectURIBindData" author="{server.hostname}">
        <createTable tableName="RURIBN">
            <column name="RUBNID" type="bigint">
                <constraints primaryKey="true"/>
            </column>
            <column name="RUBNTP" type="varchar(20)">
                <constraints nullable="false"/>
            </column>
            <column name="URIID" type="bigint">
                <constraints foreignKeyName="BURIID" referencedTableName="REDURI" referencedColumnNames="URIID" nullable="false"/>
            </column>
            <column name="RCLTID" type="bigint"/>
            <column name="CODE" type="varchar(10)"/>
            <column name="DIVI" type="varchar(3)"/>
        </createTable>
    </changeSet>
</databaseChangeLog>